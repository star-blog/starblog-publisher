<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:StarBlogPublisher.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:md="clr-namespace:Markdown.Avalonia;assembly=Markdown.Avalonia"
        mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="650"
        x:Class="StarBlogPublisher.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="StarBlogPublisher"
        WindowStartupLocation="CenterOwner"
        MinWidth="800" MinHeight="600">

    <Design.DataContext>
        <vm:MainWindowViewModel />
    </Design.DataContext>

    <Grid RowDefinitions="Auto,*,Auto" Background="{DynamicResource SystemChromeLowColor}">
        <!-- é¡¶éƒ¨åŒºåŸŸï¼šLogoå’Œè½¯ä»¶ä¿¡æ¯ -->
        <Border Classes="Card" Grid.Row="0" Margin="10">
            <Grid ColumnDefinitions="Auto,*,Auto" Margin="10">
                <!-- Logo -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="StarBlog Publisher" FontSize="24" FontWeight="Bold" Margin="0,0,10,0" />
                </StackPanel>

                <!-- ç©ºç™½åŒºåŸŸ -->
                <Grid Grid.Column="1" />

                <!-- è½¯ä»¶ä¿¡æ¯å’Œä¸»é¢˜åˆ‡æ¢ -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="8"
                            VerticalAlignment="Center">
                    <!-- ç™»å½•çŠ¶æ€å’ŒæŒ‰é’® -->
                    <StackPanel Orientation="Vertical" VerticalAlignment="Center" Margin="0,0,10,0">
                        <TextBlock Text="{Binding LoginStatusMessage}" FontSize="12" HorizontalAlignment="Right" />
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="5">
                            <Button Content="ç™»å½•"
                                    Command="{Binding LoginCommand}"
                                    IsVisible="{Binding !IsLoggedIn}"
                                    Classes="IconButton"
                                    Padding="8,3" />
                            <Button Content="ç™»å‡º"
                                    Command="{Binding LogoutCommand}"
                                    IsVisible="{Binding IsLoggedIn}"
                                    Classes="IconButton"
                                    Padding="8,3" />
                        </StackPanel>
                    </StackPanel>

                    <Button Command="{Binding ToggleThemeCommand}"
                            Content="{Binding IsDarkTheme, Converter={StaticResource BoolToThemeTextConverter}}"
                            Padding="10"
                            Classes="IconButton" />
                    <Button Content="âš™ï¸ è®¾ç½®" Padding="10"
                            Classes="IconButton"
                            Command="{Binding ShowSettingsCommand}" />
                    <Button Content="â„¹ï¸ å…³äºŽ" Padding="10"
                            Classes="IconButton"
                            Command="{Binding ShowAboutCommand}" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <Grid Grid.Row="1" ColumnDefinitions="*,*" Margin="10">
            <!-- å·¦ä¾§ï¼šæ–‡ä»¶é€‰æ‹©å’Œæ–‡æœ¬æ˜¾ç¤º -->
            <Grid Grid.Column="0" RowDefinitions="Auto,*" Margin="0,0,5,0">
                <!-- æ–‡ä»¶æ‹–æ”¾åŒºåŸŸ -->
                <Border Grid.Row="0"
                        BorderBrush="{DynamicResource SystemAccentColor}"
                        BorderThickness="2"
                        CornerRadius="4"
                        Padding="10"
                        Margin="0,0,0,10"
                        DragDrop.AllowDrop="True">
                    <Grid RowDefinitions="*,Auto">
                        <TextBlock Grid.Row="0"
                                   Text="æ‹–æ”¾Markdownæ–‡ä»¶åˆ°æ­¤å¤„ï¼Œæˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Margin="0,10" />
                        <Button Grid.Row="1"
                                Content="é€‰æ‹©æ–‡ä»¶"
                                HorizontalAlignment="Center"
                                Command="{Binding SelectFileCommand}" />
                    </Grid>
                </Border>

                <!-- æ–‡æœ¬æ˜¾ç¤ºåŒºåŸŸ -->
                <Border Grid.Row="1"
                        BorderBrush="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                        BorderThickness="1"
                        CornerRadius="4">
                    <ScrollViewer>
                        <TextBox Text="{Binding ArticleContent}"
                                 AcceptsReturn="True"
                                 TextWrapping="Wrap"
                                 IsReadOnly="True" />
                    </ScrollViewer>
                </Border>
            </Grid>

            <!-- å³ä¾§ï¼šæ–‡ç« ä¿¡æ¯ç¼–è¾‘åŒºåŸŸ -->
            <Grid Grid.Column="1" RowDefinitions="*" Margin="5,0,0,0">
                <!-- æ–‡ç« ä¿¡æ¯ç¼–è¾‘åŒºåŸŸ -->
                <Border Grid.Row="0"
                        Classes="Card"
                        Background="{DynamicResource SystemAltHighColor}">
                    <Grid RowDefinitions="Auto,Auto,Auto,*" Margin="10">
                        <TextBlock Grid.Row="0" Margin="5"
                                   Text="æ–‡ç« ä¿¡æ¯" FontWeight="Bold" FontSize="16" />

                        <!-- æ ‡é¢˜è¾“å…¥ -->
                        <StackPanel Grid.Row="1" Spacing="5" Margin="5">
                            <TextBlock Text="æ ‡é¢˜" FontWeight="SemiBold" />
                            <TextBox Text="{Binding ArticleTitle}"
                                     Watermark="è¯·è¾“å…¥æ–‡ç« æ ‡é¢˜" />
                        </StackPanel>

                        <!-- è¯´æ˜Žè¾“å…¥ -->
                        <StackPanel Grid.Row="2" Spacing="5" Margin="5">
                            <TextBlock Text="è¯´æ˜Ž" FontWeight="SemiBold" />
                            <TextBox Text="{Binding ArticleDescription}"
                                     Height="60"
                                     AcceptsReturn="True"
                                     TextWrapping="Wrap"
                                     Watermark="è¯·è¾“å…¥æ–‡ç« è¯´æ˜Ž" />
                        </StackPanel>

                        <!-- åˆ†ç±»é€‰æ‹© -->
                        <Grid Grid.Row="3" RowDefinitions="Auto,*" Margin="5"
                              IsVisible="{Binding IsLoggedIn}">
                            <Grid Grid.Row="0" ColumnDefinitions="Auto,*,Auto" Margin="0,0,0,5">
                                <TextBlock Grid.Column="0" Text="åˆ†ç±»" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                <Button Grid.Column="2" Content="ðŸ”„" ToolTip.Tip="åˆ·æ–°åˆ†ç±»" 
                                        Command="{Binding RefreshCategoriesCommand}"
                                        Classes="IconButton" Padding="5,2"/>
                            </Grid>
                            <TreeView Grid.Row="1"
                                      MinHeight="100"
                                      ItemsSource="{Binding Categories}"
                                      SelectedItem="{Binding SelectedCategory}">
                                <TreeView.ItemTemplate>
                                    <TreeDataTemplate ItemsSource="{Binding Nodes}">
                                        <TextBlock Text="{Binding Text}"/>
                                    </TreeDataTemplate>
                                </TreeView.ItemTemplate>
                            </TreeView>
                        </Grid>
                    </Grid>
                </Border>
            </Grid>
        </Grid>


        <!-- åº•éƒ¨åŒºåŸŸï¼šé¢„è§ˆæŒ‰é’®ã€å‘å¸ƒæŒ‰é’®ã€è¿›åº¦æ¡å’ŒçŠ¶æ€æ˜¾ç¤º -->
        <Grid Grid.Row="2" ColumnDefinitions="Auto,Auto,*,Auto" Margin="10">
            <!-- é¢„è§ˆæŒ‰é’® -->
            <Button Grid.Column="0"
                    Content="é¢„è§ˆæ–‡ç« "
                    Command="{Binding PreviewCommand}"
                    IsEnabled="{Binding CanPublish}"
                    Padding="15,10"
                    Margin="0,0,10,0" />

            <!-- å‘å¸ƒæŒ‰é’® -->
            <Button Grid.Column="1"
                    Content="å‘å¸ƒæ–‡ç« "
                    Command="{Binding PublishCommand}"
                    IsEnabled="{Binding CanPublish}"
                    Padding="15,10" />

            <!-- è¿›åº¦æ¡ -->
            <ProgressBar Grid.Column="2"
                         Value="{Binding PublishProgress}"
                         IsVisible="{Binding IsPublishing}"
                         Margin="10,0" />

            <!-- çŠ¶æ€æ˜¾ç¤º -->
            <TextBlock Grid.Column="3"
                       Text="{Binding StatusMessage}"
                       VerticalAlignment="Center" />
        </Grid>
    </Grid>
</Window>